FROM localhost/apache-shibboleth

ARG PARAM_VUFIND_SRC=/var/www/cpk
ARG PARAM_VUFIND_PORT=443

COPY ./cpk-foreground /usr/local/bin/

WORKDIR /var/www/cpk

EXPOSE 80
EXPOSE ${PARAM_VUFIND_PORT}

# What was specified as argument on build time, pass as ENV ..
ENV PARAM_VUFIND_SRC=${PARAM_VUFIND_SRC}
ENV PARAM_VUFIND_PORT=${PARAM_VUFIND_PORT}
ENV PARAM_VUFIND_ROBOTS_TXT=${PARAM_VUFIND_ROBOTS_TXT}
#ENV PARAM_VUFIND_CONFIG_DIR=${PARAM_VUFIND_CONFIG_DIR}
ENV PARAM_VUFIND_GOOGLE_API_KEY=${PARAM_VUFIND_GOOGLE_API_KEY}
ENV PARAM_VUFIND_CAPTCHA_SITE_KEY=${PARAM_VUFIND_CAPTCHA_SITE_KEY}
ENV PARAM_VUFIND_CAPTCHA_SECRET_KEY=${PARAM_VUFIND_CAPTCHA_SECRET_KEY}
ENV PARAM_VUFIND_MYSQL_URL=${PARAM_VUFIND_MYSQL_URL}
ENV PARAM_VUFIND_ZISKEJ_API_USERNAME=${PARAM_VUFIND_ZISKEJ_API_USERNAME}
ENV PARAM_VUFIND_ZISKEJ_API_PASSWORD=${PARAM_VUFIND_ZISKEJ_API_PASSWORD}
ENV PARAM_VUFIND_REDIS_HOST=${PARAM_VUFIND_REDIS_HOST}
ENV PARAM_VUFIND_REDIS_PASSWORD=${PARAM_VUFIND_REDIS_PASSWORD}

CMD ["cpk-foreground"]
